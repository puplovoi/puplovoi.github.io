<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>2024 moectf | Puplovoi&#39;s blog</title>
  <meta name="keywords" content="">
  <meta name="description" content="2024 moectf | Puplovoi&#39;s blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="All Categories">
<meta property="og:url" content="https://puplovoi.github.io/categories/index.html">
<meta property="og:site_name" content="Puplovoi&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-02T12:00:02.000Z">
<meta property="article:modified_time" content="2024-10-05T02:26:18.662Z">
<meta property="article:author" content="puplovoi">
<meta property="article:tag" content="CTF, Crypto">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="false" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>puplovoi</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/puplovoi"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:2921642540@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="ÊØîËµõÂ∞èÂ±ã">
            
            ÊØîËµõÂ∞èÂ±ã
            
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  site_url"
               
               href="/about">About</a>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="4">
<input type="hidden" id="yelog_site_word_count" value="4.5k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All ÊØîËµõÂ∞èÂ±ã "
           href="/2024/10/22/bb6cbb89/"
           data-tag=""
           data-author="puplovoi" >
            <span class="post-title" title="2024 moectf">2024 moectf</span>
            <span class="post-date" title="2024-10-22 13:59:00">2024/10/22</span>
        </a>
        
        
        <a  class="All ÊØîËµõÂ∞èÂ±ã "
           href="/2024/10/22/7314e54a/"
           data-tag=""
           data-author="puplovoi" >
            <span class="post-title" title="2024 Ê∫êÈ≤ÅÊùØ">2024 Ê∫êÈ≤ÅÊùØ</span>
            <span class="post-date" title="2024-10-22 13:49:51">2024/10/22</span>
        </a>
        
        
        <a  class="All ÊØîËµõÂ∞èÂ±ã "
           href="/2024/10/22/6ddd94e3/"
           data-tag=""
           data-author="puplovoi" >
            <span class="post-title" title="2024 newstar">2024 newstar</span>
            <span class="post-date" title="2024-10-22 13:49:18">2024/10/22</span>
        </a>
        
        
        <a  class="All ÊØîËµõÂ∞èÂ±ã "
           href="/2024/10/22/2f72a073/"
           data-tag=""
           data-author="puplovoi" >
            <span class="post-title" title="2024 SHCTF">2024 SHCTF</span>
            <span class="post-date" title="2024-10-22 13:49:11">2024/10/22</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-moectf" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">2024 moectf</h1>
    
    <div class="article-meta">
        
        
        <span class="author"><a>puplovoi</a></span>
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="ÊØîËµõÂ∞èÂ±ã">ÊØîËµõÂ∞èÂ±ã</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2024-10-22 13:59:58'>2024-10-22 13:59</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:1.2k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views üëÄ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Signin"><span class="toc-text">Signin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rsa-revenge"><span class="toc-text">rsa_revenge</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DA-BAI-TU"><span class="toc-text">DA_BAI_TU</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ez-hash"><span class="toc-text">ez_hash</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#new-system"><span class="toc-text">new_system</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#small-and-big"><span class="toc-text">small_and_big</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#baby-equation"><span class="toc-text">baby_equation</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h1><pre><code class="python">from Crypto.Util.number import *
from sympy import symbols, solve
import gmpy2

c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746
pq = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462
qp = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860
n = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903
p_q = 279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496
e = 65537

x = symbols(&#39;x&#39;)
equation = x**2 - p_q*x + n
solutions = solve(equation, x)
p = int(solutions[0])
q = int(solutions[1])
phi = (p - 1) * (q - 1)
d = gmpy2.invert(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
</code></pre>
<h1 id="rsa-revenge"><a href="#rsa-revenge" class="headerlink" title="rsa_revenge"></a>rsa_revenge</h1><pre><code class="python">from Crypto.Util.number import getPrime, isPrime, bytes_to_long
from secret import flag


def emirp(x):
  y = 0
  while x !=0:
    y = y*2 + x%2
    x = x//2
  return y


while True:
  p = getPrime(512)
  q = emirp(p)
  if isPrime(q):
    break

n = p*q
e = 65537
m = bytes_to_long(flag)
c = pow(m,e,n)
print(f&quot;&#123;n = &#125;&quot;)
print(f&quot;&#123;c = &#125;&quot;)

&quot;&quot;&quot;
n = 141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901
c = 47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597
&quot;&quot;&quot;
</code></pre>
<p>exp:</p>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2

e = 65537
n = 141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901
c = 47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597
def t(a, b, k):
    # sqrt(n)Êúâ512‰Ωç2ËøõÂà∂‰Ωç, ÈúÄËÆ°ÁÆóÈ´ò‰Ωé‰ΩçÊØèËæπÁöÑ256‰Ωç
  if k == 256:
    if a*b == n:
      print(a, b)
    return
  for i in range(2):
    for j in range(2):
            # ÂØπ‰∏§‰∏™Á¥†Êï∞Âõ†Â≠êÂ∞ùËØïÁàÜÁ†¥Êú™ÈÅçÂéÜÁöÑ‰ΩçÁàÜÁ†¥
      a1 = a + i*(2**k) + j*(2**(511-k))
      b1 = b + j*(2**k) + i*(2**(511-k))
      if a1*b1 &gt; n:
                # ÂΩìa1Âíåb1ËøáÂ§ß
        continue
      if (a1+(2**(511-k)))*(b1+(2**(511-k))) &lt; n:
                # ÂΩìa1Âíåb1ËøáÂ∞è
        continue
      if ((a1*b1)%(2**(k+1))) != (n%(2**(k+1))):
                # ÂΩìa1*b1ÁöÑÊúÄÂêék+1‰ΩçÔºà‰∏çÂèòÔºâ‰∏énÁöÑÊúÄÂêék+1‰Ωç‰∏çÂêå
        continue
            # Êª°Ë∂≥Êù°‰ª∂ÁöÑ(a1,b1)ÂÄºÔºåÂ∞ùËØïÁªßÁª≠ÈÅçÂéÜ
      t(a1, b1, k+1)

# ‰∏§‰∏™Á¥†Êï∞Âõ†Â≠êÊúâ512‰Ωç2ËøõÂà∂‰Ωç, Â∞ùËØïÂèØËÉΩÁöÑÊâÄÊúâ‰∏≠Èó¥‰Ωç
for i in range(2):
  t(i*(2**256), i*(2**256), 0)

p = 12119998731259483292178496920109290754181396164390285597126378297678818779092115139911720576157973310671490865211601201831597946479039132512609504866583931
q = 11660635291534613230423193509391946961264539191735481147071890944740311229658362673314192872117237108949853531941630122241060679012089130178372253390640871
phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(long_to_bytes(m))
</code></pre>
<h1 id="DA-BAI-TU"><a href="#DA-BAI-TU" class="headerlink" title="DA_BAI_TU"></a>DA_BAI_TU</h1><pre><code class="python">from Crypto.Util.number import *

flag = b&#39;moectf&#123;xxxxxxxxxx&#125;&#39;
m = bytes_to_long(flag)

e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697

def encrypt(m , e1 , e2):
  p = getPrime(512)
  q = getPrime(512)
  N = p*q
  c1 = pow((3*p + 7*q),e1,N)
  c2 = pow((2*p + 5*q),e2,N)
  e = 65537
  c = pow(m , e , N)
  return c
  

print(encrypt(m ,e1 , e2))

&#39;&#39;&#39;
N = 107840121617107284699019090755767399009554361670188656102287857367092313896799727185137951450003247965287300048132826912467422962758914809476564079425779097585271563973653308788065070590668934509937791637166407147571226702362485442679293305752947015356987589781998813882776841558543311396327103000285832158267
c1 = 15278844009298149463236710060119404122281203585460351155794211733716186259289419248721909282013233358914974167205731639272302971369075321450669419689268407608888816060862821686659088366316321953682936422067632021137937376646898475874811704685412676289281874194427175778134400538795937306359483779509843470045
c2 = 21094604591001258468822028459854756976693597859353651781642590543104398882448014423389799438692388258400734914492082531343013931478752601777032815369293749155925484130072691903725072096643826915317436719353858305966176758359761523170683475946913692317028587403027415142211886317152812178943344234591487108474
c = 21770231043448943684137443679409353766384859347908158264676803189707943062309013723698099073818477179441395009450511276043831958306355425252049047563947202180509717848175083113955255931885159933086221453965914552773593606054520151827862155643433544585058451821992566091775233163599161774796561236063625305050
&#39;&#39;&#39;
</code></pre>
<p>exp:</p>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2

N = 107840121617107284699019090755767399009554361670188656102287857367092313896799727185137951450003247965287300048132826912467422962758914809476564079425779097585271563973653308788065070590668934509937791637166407147571226702362485442679293305752947015356987589781998813882776841558543311396327103000285832158267
c1 = 15278844009298149463236710060119404122281203585460351155794211733716186259289419248721909282013233358914974167205731639272302971369075321450669419689268407608888816060862821686659088366316321953682936422067632021137937376646898475874811704685412676289281874194427175778134400538795937306359483779509843470045
c2 = 21094604591001258468822028459854756976693597859353651781642590543104398882448014423389799438692388258400734914492082531343013931478752601777032815369293749155925484130072691903725072096643826915317436719353858305966176758359761523170683475946913692317028587403027415142211886317152812178943344234591487108474
c = 21770231043448943684137443679409353766384859347908158264676803189707943062309013723698099073818477179441395009450511276043831958306355425252049047563947202180509717848175083113955255931885159933086221453965914552773593606054520151827862155643433544585058451821992566091775233163599161774796561236063625305050
e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697
e = 65537

kq = pow(2, e1 * e2, N)*pow(c1, e2, N) - pow(3,e1 * e2, N)*pow(c2, e1, N)
q = gmpy2.gcd(kq, N)
p = N // q
phi = (p-1)*(q-1)
d = gmpy2.invert(e, phi)
m = pow(c, d, N)
print(long_to_bytes(m))
</code></pre>
<h1 id="ez-hash"><a href="#ez-hash" class="headerlink" title="ez_hash"></a>ez_hash</h1><pre><code class="python">from hashlib import sha256
from secret import flag, secrets

assert flag == b&#39;moectf&#123;&#39; + secrets + b&#39;&#125;&#39;
assert secrets[:4] == b&#39;2100&#39; and len(secrets) == 10
hash_value = sha256(secrets).hexdigest()
print(f&quot;&#123;hash_value = &#125;&quot;)
hash_value = &#39;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#39;
</code></pre>
<p>exp:</p>
<pre><code class="python">from hashlib import sha256
from Crypto.Util.number import *

hash_value = &#39;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#39;

for i in range(256**7):
  secrets = b&#39;2100&#39; + str(i).encode()
  if sha256(secrets).hexdigest() == hash_value:
    print(f&quot;&#123;secrets = &#125;&quot;)
    break
  
secrets = b&#39;2100360168&#39;
flag = b&#39;moectf&#123;&#39; + secrets + b&#39;&#125;&#39;
print(flag)
</code></pre>
<h1 id="new-system"><a href="#new-system" class="headerlink" title="new_system"></a>new_system</h1><pre><code class="python">from random import randint
from Crypto.Util.number import getPrime,bytes_to_long 


flag = b&#39;moectf&#123;???????????????&#125;&#39;
gift = bytes_to_long(flag)


def parametergenerate():
  q = getPrime(256)
  gift1 = randint(1, q)
  gift2 = (gift - gift1) % q
  x = randint(1, q)
  assert gift == (gift1 + gift2) % q
  return q , x , gift1, gift2


def encrypt(m , q , x):
  a = randint(1, q)
  c = (a*x + m) % q
  return [a , c]


q , x , gift1 , gift2 = parametergenerate()
print(encrypt(gift1 , q , x))
print(encrypt(gift2 , q , x))
print(encrypt(gift , q , x))
print(f&#39;q = &#123;q&#125;&#39;)

&#39;&#39;&#39;
[48152794364522745851371693618734308982941622286593286738834529420565211572487, 21052760152946883017126800753094180159601684210961525956716021776156447417961]
[48649737427609115586886970515713274413023152700099032993736004585718157300141, 6060718815088072976566240336428486321776540407635735983986746493811330309844]
[30099883325957937700435284907440664781247503171217717818782838808179889651361, 85333708281128255260940125642017184300901184334842582132090488518099650581761]
q = 105482865285555225519947662900872028851795846950902311343782163147659668129411
&#39;&#39;&#39;
</code></pre>
<p>exp:</p>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2


ac1 = [48152794364522745851371693618734308982941622286593286738834529420565211572487, 21052760152946883017126800753094180159601684210961525956716021776156447417961]
ac2 = [48649737427609115586886970515713274413023152700099032993736004585718157300141, 6060718815088072976566240336428486321776540407635735983986746493811330309844]
ac3 = [30099883325957937700435284907440664781247503171217717818782838808179889651361, 85333708281128255260940125642017184300901184334842582132090488518099650581761]
q = 105482865285555225519947662900872028851795846950902311343782163147659668129411

x = (ac1[1] + ac2[1] - ac3[1]) * gmpy2.invert(ac1[0] + ac2[0] - ac3[0], q) % q
gift = (ac3[1] - x * ac3[0]) % q
print(long_to_bytes(gift))
</code></pre>
<h1 id="small-and-big"><a href="#small-and-big" class="headerlink" title="small_and_big"></a>small_and_big</h1><pre><code class="python">from secret import flag
from Crypto.Util.number import*
m = bytes_to_long(flag)
p = getPrime(1024)
q = getPrime(1024)
n = p*q
e = 3
c = pow(m,e,n)
&#39;&#39;&#39;
c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757
e = 3
n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787
&#39;&#39;&#39;
</code></pre>
<p>exp:</p>
<pre><code class="python">from Crypto.Util.number import*
import gmpy2

c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757
e = 3
n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787

k = 0
while(1):
  m = k * n + c
  a, b = gmpy2.iroot(m, e)
  if b:
    print(long_to_bytes(a))
    break
  k += 1
</code></pre>
<h1 id="baby-equation"><a href="#baby-equation" class="headerlink" title="baby_equation"></a>baby_equation</h1><pre><code class="python">from Crypto.Util.number import *
from secret import flag

l = len(flag)
m1, m2 = flag[:l//2], flag[l//2:]
a = bytes_to_long(m1)
b = bytes_to_long(m2)
k = 0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40
assert ((a**2 + 1)*(b**2 + 1) - 2*(a - b)*(a*b - 1)) == 4*(k + a*b)
</code></pre>
<p>exp:</p>
<pre><code class="python">import gmpy2
from Crypto.Util.number import long_to_bytes


def find(tot, index, ls):
    &quot;&quot;&quot;
    ÈÄíÂΩíÊü•ÊâæÂáΩÊï∞ÔºåÁî®‰∫éÂØªÊâæÂêàÈÄÇÁöÑÂõ†Â≠êÁªÑÂêàÔºå‰ΩøÂæóÈÄöËøáËøô‰∫õÂõ†Â≠êÊûÑÈÄ†Âá∫ÁöÑÊï∞Â≠óËÉΩÂ§üËøòÂéüÂá∫ flag„ÄÇ
    :param tot: ÂΩìÂâçÁöÑ‰πòÁßØÂÄºÔºàÂàùÂßãÂÄº‰∏∫1Ôºâ„ÄÇ
    :param index: ÂΩìÂâçÂ§ÑÁêÜÁöÑÂõ†Â≠êÁ¥¢Âºï„ÄÇ
    :param ls: Âõ†Â≠êÂàóË°®ÔºåÂåÖÂê´ÊâÄÊúâÂèØËÉΩÁöÑÂõ†Â≠ê„ÄÇ
    :return: Êª°Ë∂≥Êù°‰ª∂ÁöÑ‰πòÁßØÂÄºÔºåÂ¶ÇÊûúÊú™ÊâæÂà∞ÂàôËøîÂõû0„ÄÇ
    &quot;&quot;&quot;
    # Âü∫ÂáÜÊÉÖÂÜµÔºöÂ¶ÇÊûúÂ∑≤ÁªèÊ£ÄÊü•‰∫ÜÊâÄÊúâÂõ†Â≠ê
    if index == len(ls):
        # Ê£ÄÊü•ÂΩìÂâçÁöÑ tot ÊòØÂê¶ÂèØËÉΩÂåÖÂê´ flag ÁöÑÁâπÂæÅÂ≠óÁ¨¶‰∏≤Ôºà‰æãÂ¶Ç &#39;moectf&#123;&#39;Ôºâ
        if b&#39;moectf&#123;&#39; in long_to_bytes(tot):
            return tot  # ËøîÂõûÊâæÂà∞ÁöÑÂÄº
        return 0  # Ê≤°ÊâæÂà∞ËøîÂõû 0

    # ÈÄíÂΩíÊü•ÊâæÔºåÂ∞ùËØïÂåÖÂê´ÂΩìÂâçÂõ†Â≠êÁöÑÊÉÖÂÜµ
    a = find(tot * ls[index], index + 1, ls)
    # ÈÄíÂΩíÊü•ÊâæÔºåÂ∞ùËØï‰∏çÂåÖÂê´ÂΩìÂâçÂõ†Â≠êÁöÑÊÉÖÂÜµ
    b = find(tot, index + 1, ls)

    # ËøîÂõûÊâæÂà∞ÁöÑÈùûÈõ∂ÁªìÊûú
    return a if a != 0 else b


# ÁªôÂÆöÁöÑÂ∏∏Èáè k ÂÄº
k = 0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40

# ËÆ°ÁÆó a1b1 = sqrt(4 * k)
a1b1 = gmpy2.iroot(4 * k, 2)[0]

# Âõ†Â≠êÂàóË°®ÔºåÂåÖÂê´ÂèØËÉΩÂàÜËß£Âá∫ÁöÑÂõ†Â≠êÁªÑÂêà
fac = [
    2, 2, 2, 2, 3, 3, 31, 61, 223, 4013, 281317, 4151351, 339386329, 370523737,
    5404604441993, 26798471753993, 25866088332911027256931479223,
    64889106213996537255229963986303510188999911
]

# ‰ΩøÁî®ÈÄíÂΩíÊü•ÊâæÂõ†Â≠êÁªÑÂêàÔºåÂæóÂà∞ a1
a1 = find(1, 0, fac)

# ËÆ°ÁÆó b1 = a1b1 // a1
b1 = a1b1 // a1

# ‰ΩøÁî® long_to_bytes Â∞Ü a1 Âíå b1 ËΩ¨Êç¢‰∏∫Â≠óËäÇÂπ∂ËæìÂá∫ flag
print(long_to_bytes(a1 - 1) + long_to_bytes(b1 + 1))
</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> Ê¨¢ËøéÊåáÂá∫‰ªª‰ΩïÊúâÈîôËØØÊàñ‰∏çÂ§üÊ∏ÖÊô∞ÁöÑË°®ËææÔºåÂèØ‰ª•ÈÇÆ‰ª∂Ëá≥ 2921642540@qq.com ËøõË°åÂèçÈ¶à„ÄÇ </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">üí∞</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ¬©2024 Puplovoi
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">√ó</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="Êâ´Á†ÅÊîØÊåÅ">
            <img src="/img/weixin.jpg" class="weixin" title="Êâ´Á†ÅÊîØÊåÅ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*Ê∏≤ÊüìÂØπÂ∫îÁöÑË°®Ê†ºÊ†∑Âºè*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*Ê∏≤ÊüìÊâìËµèÊ†∑Âºè*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*È´ò‰∫Æ‰ª£Á†ÅÂùóË°åÂè∑*/
        

        /*ËÆøÈóÆÊï∞Èáè*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*‰ª£Á†ÅÈ´ò‰∫ÆÔºåË°åÂè∑ÂØπÈΩê*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*ÊâìËµèÈ°µÈù¢ÈöêËóè‰∏éÂ±ïÁ§∫*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--Âä†ÂÖ•Ë°åÂè∑ÁöÑÈ´ò‰∫Æ‰ª£Á†ÅÂùóÊ†∑Âºè-->

<!--Ëá™ÂÆö‰πâÊ†∑ÂºèËÆæÁΩÆ-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*ÂàóË°®Ê†∑Âºè*/
    

    /* ËÉåÊôØÂõæÊ†∑Âºè */
    
    


    /*ÂºïÁî®ÂùóÊ†∑Âºè*/
    

    /*ÊñáÁ´†ÂàóË°®ËÉåÊôØÂõæ*/
    

    
</style>







</html>
